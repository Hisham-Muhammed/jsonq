<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Match Stats & Boosters Pro</title>
    <style>
        :root {
            --primary: #1e3a8a;
            --secondary: #3b82f6;
            --accent: #10b981;
            --danger: #ef4444;
            --bg: #f1f5f9;
        }
        body { font-family: 'Inter', system-ui, sans-serif; background: var(--bg); margin: 0; padding: 10px; color: #1e293b; }
        .container { max-width: 1000px; margin: auto; background: white; padding: 20px; border-radius: 16px; box-shadow: 0 10px 30px rgba(0,0,0,0.08); }
        
        /* Match Setup */
        .match-setup { display: grid; grid-template-columns: 1fr auto 1fr; align-items: center; gap: 15px; margin-bottom: 20px; background: #fff; border: 1px solid #e2e8f0; padding: 15px; border-radius: 12px; }
        .team-config { display: flex; flex-direction: column; gap: 5px; }
        .team-config input { padding: 8px; font-weight: 800; border: 2px solid #cbd5e1; border-radius: 6px; text-align: center; text-transform: uppercase; width: 100%; box-sizing: border-box; }
        .vs-circle { background: var(--primary); color: white; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; border-radius: 50%; font-weight: 900; }

        /* Team Tabs */
        .team-tabs { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 15px; }
        .tab-btn { padding: 12px; border: 2px solid #e2e8f0; border-radius: 10px; background: #f8fafc; cursor: pointer; font-weight: 700; transition: 0.2s; text-align: center; }
        .tab-btn.active { border-color: var(--secondary); background: #eff6ff; color: var(--primary); }

        /* Selectors */
        .selection-zone { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px; background: #f8fafc; padding: 15px; border-radius: 10px; }
        .input-group { display: flex; flex-direction: column; gap: 4px; }
        label { font-size: 0.7rem; font-weight: 800; color: #64748b; text-transform: uppercase; }
        select, input[type="number"] { padding: 10px; border: 1px solid #cbd5e1; border-radius: 8px; font-size: 0.95rem; width: 100%; box-sizing: border-box; }

        /* Boosters */
        .booster-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 8px; margin-bottom: 20px; padding: 12px; background: #fffbeb; border: 1px solid #fde68a; border-radius: 10px; }
        .booster-item { display: flex; align-items: center; gap: 8px; font-size: 0.8rem; font-weight: 600; cursor: pointer; }

        /* Stats Grid */
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(130px, 1fr)); gap: 10px; margin-bottom: 15px; }
        .checkbox-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 8px; margin-bottom: 20px; }

        /* Points Bar */
        .points-bar { background: var(--primary); color: white; padding: 15px; border-radius: 10px; display: flex; flex-direction: column; gap: 5px; margin-bottom: 20px; }
        .points-header { display: flex; justify-content: space-between; align-items: center; }
        .points-val { font-size: 2rem; font-weight: 900; color: #60a5fa; }
        .sr-display { font-size: 0.8rem; color: #94a3b8; font-weight: 600; }

        /* Actions */
        .actions { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .btn { padding: 15px; border: none; border-radius: 10px; font-weight: 800; cursor: pointer; font-size: 1rem; transition: 0.2s; }
        .btn-save { background: var(--accent); color: white; }
        .btn-dl { background: #334155; color: white; }

        /* Log */
        .log-section { margin-top: 30px; border-top: 2px solid #f1f5f9; padding-top: 20px; }
        .log-list { display: flex; flex-direction: column; gap: 8px; max-height: 400px; overflow-y: auto; }
        .log-entry { display: flex; justify-content: space-between; padding: 10px; background: #fff; border: 1px solid #e2e8f0; border-radius: 8px; font-size: 0.85rem; align-items: center; }
        .log-tag { font-size: 0.65rem; background: #dbeafe; padding: 2px 6px; border-radius: 4px; margin-left: 3px; font-weight: 700; color: #1e40af; }
    </style>
</head>
<body>

<div class="container">
    <!-- Match Setup -->
    <div class="match-setup">
        <div class="team-config">
            <label>Team 1 Code</label>
            <input type="text" id="t1_code" value="IND" oninput="updateFN()">
        </div>
        <div class="vs-circle">VS</div>
        <div class="team-config">
            <label>Team 2 Code</label>
            <input type="text" id="t2_code" value="PAK" oninput="updateFN()">
        </div>
    </div>

    <!-- Active Team Selection -->
    <div class="team-tabs">
        <div class="tab-btn active" id="tab1" onclick="switchTeam(1)">TEAM 1 PLAYERS</div>
        <div class="tab-btn" id="tab2" onclick="switchTeam(2)">TEAM 2 PLAYERS</div>
    </div>

    <div class="selection-zone">
        <div class="input-group">
            <label id="countryLabel">Select Team 1 Country</label>
            <select id="countrySelect" onchange="loadPlayers()"><option value="">-- Choose --</option></select>
        </div>
        <div class="input-group">
            <label>Player Name</label>
            <select id="playerSelect" onchange="calc()"><option value="">-- Pick Player --</option></select>
        </div>
    </div>

    <!-- Boosters -->
    <label class="label" style="font-weight: 800; font-size: 0.75rem; margin-bottom: 5px; display: block;">BOOSTERS</label>
    <div class="booster-grid">
        <label class="booster-item"><input type="checkbox" id="b2x"> 2x Score</label>
        <label class="booster-item"><input type="checkbox" id="bMega"> Megalomaniac</label>
        <label class="booster-item"><input type="checkbox" id="bVacc"> Vaccinate</label>
        <label class="booster-item" style="color:var(--danger)"><input type="checkbox" id="bRev"> REVERSE</label>
        <label class="booster-item"><input type="checkbox" id="bComp"> Companion</label>
        <label class="booster-item"><input type="checkbox" id="bShad"> Shadow</label>
    </div>

    <!-- Stats -->
    <div class="stats-grid">
        <div class="input-group"><label>Role</label><select id="role"><option value="bat">Bat/AR/WK</option><option value="bowl">Pure Bowler</option></select></div>
        <div class="input-group"><label>Runs Scored</label><input type="number" id="runs" value="0"></div>
        <div class="input-group"><label>Balls Faced</label><input type="number" id="balls" value="0"></div>
        <div class="input-group"><label>4s/6s</label><div style="display:flex;gap:5px"><input type="number" id="fours" value="0" placeholder="4s"><input type="number" id="sixes" value="0" placeholder="6s"></div></div>
    </div>
    <div class="stats-grid">
        <div class="input-group"><label>Wickets</label><input type="number" id="wkts" value="0"></div>
        <div class="input-group"><label>Overs Bowled</label><input type="number" id="overs" step="0.1" value="0"></div>
        <div class="input-group"><label>Dot Balls</label><input type="number" id="dots" value="0"></div>
        <div class="input-group"><label>Maidens</label><input type="number" id="maidens" value="0"></div>
    </div>

    <div class="checkbox-grid">
        <label class="check-item"><input type="checkbox" id="xi" checked> Playing XI</label>
        <label class="check-item"><input type="checkbox" id="out"> Got Out</label>
        <label class="check-item"><input type="checkbox" id="win"> Won Match</label>
        <label class="check-item"><input type="checkbox" id="mom"> MOM</label>
        <label class="check-item"><input type="checkbox" id="duck"> Last Over Duck</label>
    </div>

    <div class="points-bar">
        <div class="points-header">
            <span><strong id="displayName">...</strong>'s Points</span>
            <span class="points-val" id="totalPts">0</span>
        </div>
        <div class="sr-display" id="srDisplay">Strike Rate: 0.00</div>
    </div>

    <div class="actions">
        <button class="btn btn-save" onclick="save()">SAVE PLAYER</button>
        <button class="btn btn-dl" onclick="download()">DOWNLOAD <span id="fnLabel">INDvsPAK.json</span></button>
    </div>

    <div class="log-section">
        <label class="label" style="font-weight: 800; font-size: 0.75rem;">COLLECTED PLAYERS (<span id="count">0</span>)</label>
        <div id="logList" class="log-list" style="margin-top: 10px;"></div>
    </div>
</div>

<script>
    const roster = {
        "India": ["Suryakumar Yadav", "Ishan Kishan", "Hardik Pandya", "Axar Patel", "Tilak Varma", "Arshdeep Singh", "Varun Chakravarthy"],
        "Sri Lanka": ["Kushal Perera", "Kushal Mendis", "Dunith Wellalage", "Matheesha Pathirana", "Dushmantha Chameera", "Kamil Mishara", "Wanindu Hasaranga", "Kamindu Mendis"],
        "Pakistan": ["Shaheen Afridi", "Said Ayub", "Naseem Shah", "Muhammed Nawaz", "Faheem Ashraf", "Babar Azam", "Abrar Ahmed", "Fakhar Zaman", "Salman Agha", "Usman Khan", "Shahibzada Farhan"],
        "Australia": ["Cooper Connolly", "Nathan Ellis", "Travis Head", "Marcus Stoinis", "Josh Inglis", "Mitchell Marsh", "Matthew Kunhemann", "Xavier Bartlett", "Josh Hazlewood", "Ben Dwarshuis", "Matt Renshaw"],
        "New Zealand": ["Rachin Ravindra", "Daryl Mitchell", "Finn Allen", "Jacob Duffy", "Mark Chapman", "Glenn Phillips", "Kyle Jamieson", "Michael Bracewell"],
        "South Africa": ["Tristan Stubbs", "Quinton de Kock", "Keshav Maharaj", "Dewald Brevis", "Marco Jansen", "George Linde", "David Miller", "Lungi Ngidi", "Corbin Bosch"],
        "England": ["Jofra Archer", "Adil Rashid", "Will Jacks", "Luke Wood", "Harry Brook", "Jacob Bethell", "Jos Buttler", "Sam Curran"],
        "Afghanistan": ["Mujeeb Ur Rehman", "Ibrahim Zadran", "Sediqullah Atal", "Darwish Rasooli", "Rashid Khan", "Azmatullah Omarzai", "Fazalhaq Farooqi"],
        "West Indies": ["Jason Holder", "Gudakesh Motie", "Roston Chase", "Rovman Powell", "Shai Hope", "Brandon King", "Mathew Forde", "Johnson Charles", "Jayden Seales", "Shimron Hetmyer", "Romario Shepherd", "Akeal Hosein"],
        "Others": ["Sikandar Raza", "JJ Smuts", "Aasif Sheikh", "Monank Patel", "Logan van Beek", "Scott Edwards", "Andre Gous"]
    };

    let activeTeam = 1;
    let savedPlayers = [];
    let countryMapping = { 1: "", 2: "" };

    function init() {
        const sel = document.getElementById('countrySelect');
        Object.keys(roster).forEach(c => sel.innerHTML += `<option value="${c}">${c}</option>`);
        updateFN();
    }

    function switchTeam(id) {
        activeTeam = id;
        document.getElementById('tab1').className = id === 1 ? 'tab-btn active' : 'tab-btn';
        document.getElementById('tab2').className = id === 2 ? 'tab-btn active' : 'tab-btn';
        document.getElementById('countryLabel').innerText = `Select Team ${id} Country`;
        document.getElementById('countrySelect').value = countryMapping[id];
        loadPlayers();
    }

    function loadPlayers() {
        const country = document.getElementById('countrySelect').value;
        countryMapping[activeTeam] = country;
        const pSel = document.getElementById('playerSelect');
        pSel.innerHTML = '<option value="">-- Pick Player --</option>';
        if (roster[country]) {
            roster[country].forEach(p => pSel.innerHTML += `<option value="${p}">${p}</option>`);
        }
    }

    function calc() {
        const name = document.getElementById('playerSelect').value;
        document.getElementById('displayName').innerText = name || "...";
        
        let p = 0;
        const runs = parseInt(document.getElementById('runs').value) || 0;
        const balls = parseInt(document.getElementById('balls').value) || 0;
        const fours = parseInt(document.getElementById('fours').value) || 0;
        const sixes = parseInt(document.getElementById('sixes').value) || 0;
        const wkts = parseInt(document.getElementById('wkts').value) || 0;
        const dots = parseInt(document.getElementById('dots').value) || 0;
        const role = document.getElementById('role').value;

        // Strike Rate Calculation
        let sr = 0;
        if (balls > 0) {
            sr = (runs / balls) * 100;
        }
        document.getElementById('srDisplay').innerText = `Strike Rate: ${sr.toFixed(2)}`;

        // Base Points
        p += runs + (fours * 1) + (sixes * 2) + (wkts * 25) + dots;
        
        // Milestones
        if (runs >= 50) p += 10;
        if (runs >= 100) p += 20;
        if (wkts >= 3) p += 10;
        if (wkts >= 5) p += 20;

        // Bonuses
        if (document.getElementById('xi').checked) p += 5;
        if (document.getElementById('mom').checked) p += 50;
        if (document.getElementById('win').checked) p += 10;
        if (document.getElementById('duck').checked) p -= 15;

        // Strike Rate Bonus/Penalty
        if (balls >= 10) {
            if (sr > 200) p += 15;
            else if (sr > 150) p += 10;
            else if (sr < 100) p -= 10;
        }

        // Boosters
        if (document.getElementById('bMega').checked) {
            p += (dots * 5) + ((fours + sixes) * 5);
        }
        if (document.getElementById('b2x').checked) p *= 2;
        if (document.getElementById('bVacc').checked && p < 0) p = 0;
        if (document.getElementById('bRev').checked) p = 0;

        document.getElementById('totalPts').innerText = p;
        return { p, sr };
    }

    function save() {
        const name = document.getElementById('playerSelect').value;
        const country = document.getElementById('countrySelect').value;
        if (!name) return;

        const { p, sr } = calc();
        
        // Collect all statistics
        const statsObj = {
            name: name,
            country: country,
            teamCode: document.getElementById(`t${activeTeam}_code`).value.toUpperCase(),
            finalPoints: p,
            role: document.getElementById('role').value,
            batting: {
                runs: parseInt(document.getElementById('runs').value) || 0,
                balls: parseInt(document.getElementById('balls').value) || 0,
                fours: parseInt(document.getElementById('fours').value) || 0,
                sixes: parseInt(document.getElementById('sixes').value) || 0,
                strikeRate: parseFloat(sr.toFixed(2))
            },
            bowling: {
                wickets: parseInt(document.getElementById('wkts').value) || 0,
                overs: parseFloat(document.getElementById('overs').value) || 0,
                dots: parseInt(document.getElementById('dots').value) || 0,
                maidens: parseInt(document.getElementById('maidens').value) || 0
            },
            status: {
                playingXI: document.getElementById('xi').checked,
                out: document.getElementById('out').checked,
                wonMatch: document.getElementById('win').checked,
                mom: document.getElementById('mom').checked,
                lastOverDuck: document.getElementById('duck').checked
            },
            boosters: {
                "2x": document.getElementById('b2x').checked,
                "Mega": document.getElementById('bMega').checked,
                "Vacc": document.getElementById('bVacc').checked,
                "Reverse": document.getElementById('bRev').checked,
                "Companion": document.getElementById('bComp').checked,
                "Shadow": document.getElementById('bShad').checked
            }
        };

        savedPlayers.push(statsObj);

        // UI Log
        const log = document.getElementById('logList');
        const entry = document.createElement('div');
        entry.className = 'log-entry';
        
        const activeBoosts = Object.keys(statsObj.boosters).filter(k => statsObj.boosters[k]);
        
        entry.innerHTML = `
            <div>
                <strong>${name}</strong> <small>(${statsObj.teamCode})</small>
                <div>${activeBoosts.map(b => `<span class="log-tag">${b}</span>`).join('')}</div>
            </div> 
            <div style="text-align:right">
                <div style="font-size: 1.1rem; font-weight: 800; color: var(--primary)">${p} pts</div>
                <small style="color: #64748b">SR: ${sr.toFixed(1)}</small>
            </div>`;
        log.prepend(entry);
        
        document.getElementById('count').innerText = savedPlayers.length;
        
        // Reset inputs (except team/country)
        document.querySelectorAll('.stats-grid input, .checkbox-grid input, .booster-grid input').forEach(i => {
            if (i.type === "number") i.value = 0;
            if (i.type === "checkbox" && i.id !== 'xi') i.checked = false;
        });
        calc();
    }

    function updateFN() {
        const a = document.getElementById('t1_code').value.toUpperCase() || 'T1';
        const b = document.getElementById('t2_code').value.toUpperCase() || 'T2';
        document.getElementById('fnLabel').innerText = `${a}vs${b}.json`;
    }

    function download() {
        if (savedPlayers.length === 0) return alert("Add at least one player before downloading!");
        const dataStr = JSON.stringify(savedPlayers, null, 2);
        const blob = new Blob([dataStr], { type: 'application/json' });
        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = document.getElementById('fnLabel').innerText;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
    }

    // Real-time calculation on any input change
    document.querySelectorAll('input, select').forEach(el => {
        el.addEventListener('input', calc);
    });

    init();
</script>
</body>
</html>

